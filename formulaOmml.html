<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<script type="text/JavaScript" src="fonts/fmathFormulaFonts.js"></script>
	<script type="text/JavaScript" src="fmathFormulaC.js"></script>

	<script type="text/javascript" src="lib/jszip.min.js"></script>
	<script type="text/javascript" src="lib/utils.js"></script>
</head>
<body>
<center>
<form>
<table>
	<tr>
		<td><b>Display Word File:</b></td>
		<td><input type="file" id="files" multiple /></td>
	</tr>
	<tr>
		<td colspan="2"  align="center">
			<canvas id="importCanvas" width="0" height="0" style="border:1px solid #000000;"></canvas>
			<br/>
			<br/>
		</td>
	</tr>
	<tr>
		<td colspan="2"><b>Generate Word File from MATHML:</b></td>
	</tr>
	<tr>
		<td colspan="2">
			<textarea id="ta" style="width:600px;height:200px"> </textarea>
		</td>
	</tr>
	<tr>
		<td colspan="2" align="center">
			<canvas id="exportCanvas" width="0" height="0" style="border:1px solid #000000;"></canvas>
		</td>
	</tr>
	<tr>
		<td align="left">
			<input type="button" value="Display Formula" onclick="drawExportFormula()"></input>
		</td>

		<td align="right">
			<nobr>
			FileName:<input id="inputFileNameToSaveAs" value="newDocument">
			<input type="button" value="Generate Word" onclick="exportToWord()"></input>
			</nobr>
		</td>
	</tr>
</table>
</form>
</center>
	<script>
		FMATH.ApplicationConfiguration.setFolderUrlForFonts("fonts");
		FMATH.ApplicationConfiguration.setFolderUrlForGlyphs("glyphs");

		function exportToWord(){
			var fileName = document.getElementById("inputFileNameToSaveAs");
			var textarea = document.getElementById("ta");

			var formula = new FMATH.MathMLFormula();
			formula.downloadWordFromMathML(textarea.value, fileName.value);
		}

		function drawExportFormula(){
			var textarea = document.getElementById("ta");
			var mathml = textarea.value;

			var c=document.getElementById("exportCanvas");
			var formula = new FMATH.MathMLFormula();
			formula.drawImage(c, mathml);
		}


		document.getElementById('files').addEventListener('change', handleFileSelect, false);
		function handleFileSelect(evt) {
		    var files = evt.target.files;
		    if(files.length>0){
				var formula = new FMATH.MathMLFormula();
				formula.convertWordToMathML(files[0], drawImportFormula);
		    }
  		}

		function drawImportFormula(mathml){
			var textarea = document.getElementById("ta");
			textarea.value = mathml;

			var c=document.getElementById("importCanvas");
			var formula = new FMATH.MathMLFormula();
			formula.drawImage(c, mathml);
		}


		var ta = document.getElementById("ta");
		ta.value =
"<math mathvariant='italic'>\n"+
"    <msqrt>\n"+
"        <msup>\n"+
"            <mi>a</mi>\n"+
"            <mn>2</mn>\n"+
"        </msup>\n"+
"        <mo>+</mo>\n"+
"        <msup>\n"+
"            <mi>b</mi>\n"+
"            <mn>2</mn>\n"+
"        </msup>\n"+
"    </msqrt>\n"+
"    <mtext>+&nbsp;</mtext>\n"+
"    <msubsup>\n"+
"        <mo>&int;</mo>\n"+
"        <mn>0</mn>\n"+
"        <mn>1</mn>\n"+
"    </msubsup>\n"+
"    <msup>\n"+
"        <mi>e</mi>\n"+
"        <mi>x</mi>\n"+
"    </msup>\n"+
"</math>\n";


	</script>
</body>
</html>