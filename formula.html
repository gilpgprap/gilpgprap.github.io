<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<script type="text/JavaScript" src="fonts/fmathFormulaFonts.js"></script>
	<script type="text/JavaScript" src="fmathFormulaC.js"></script>

	<script src="menu/basicContext.min.js"></script>
	<link rel="stylesheet" href="menu/basicContext.min.css">
	<link rel="stylesheet" href="menu/default.min.css">
</head>
<body>
<center>
<form>
	<textarea id="ta" style="width:800px;height:300px">

	</textarea><br/>
	<input type="button" value="Display Formula" onclick="updateFormula()"></input><br/>
	<canvas id="myCanvas" width="0" height="0" style="border:1px solid #000000;"></canvas>
</form>
</center>
	<script>

		var formula = new FMATH.MathMLFormula();

		function getLatex(){
			var _mathml = formula.getMathMLString("ENTITIES", true);
			var latex = formula.convertMathMLToLatex(_mathml)
			alert(latex);
		}

		function getMathML(){
			alert(formula.getMathMLString("ENTITIES", true));
		}

		var lastScale = 1;
		function zoomIn(){
			lastScale = lastScale * 1.2;
			formula.scaleFormula(lastScale);
		}
		function zoomOut(){
			lastScale = lastScale / 1.2;
			formula.scaleFormula(lastScale);
		}

		function zoom100(){
			lastScale = 1;
			formula.scaleFormula(lastScale);
		}


		var onClick = function(e) {
			var goToFmath = function() { window.open('http://www.fmath.info','_blank'); }

			var onClose = function(e) {

				document.getElementById('myCanvas').classList.remove('active')
				basicContext.close()
			}

			this.classList.add('active')

			var items = [
				{ title: 'Get MathML', fn: getMathML },
				{ title: 'Get Latex', fn: getLatex },
				{ },
				{ title: 'Zoom In', fn: zoomIn },
				{ title: '100%', fn: zoom100 },
				{ title: 'Zoom Out', fn: zoomOut },
				{ },
				{ title: 'Help', fn: goToFmath }
			]

			basicContext.show(items, e, onClose)

		}

		document.addEventListener('DOMContentLoaded', function() {
			document.getElementById('myCanvas').addEventListener('click', onClick)
		})




		FMATH.ApplicationConfiguration.setFolderUrlForFonts("fonts");
		FMATH.ApplicationConfiguration.setFolderUrlForGlyphs("glyphs");

		function drawFormulaOnCanvas( id, mathml){
			var c=document.getElementById(id);
			formula.drawImage(c, mathml);
		}

		function updateFormula(){
			var textarea = document.getElementById("ta");
			drawFormulaOnCanvas("myCanvas", textarea.value);
		}


		var textarea = document.getElementById("ta");
		textarea.value =
'<math mathsize="45">\n' +
'	<mspace linebreak="newline" indentalign="center"></mspace>\n' +
'	<mtext style="border:1px;" mathsize="50">MathML Fundamentals - msqrt, mroot</mtext>\n' +
'\n' +
'	<mspace linebreak="newline" indentalign="center"></mspace>\n' +
'	<mrow style="border:1px;" baseline="true">\n' +
'		<mtext>aaa</mtext>\n' +
'		<msqrt style="border:1px">\n' +
'			<mrow  style="border:1px">\n' +
'				<mi style="border:1px">aagg </mi>\n' +
'				<mo>+</mo>\n' +
'				<mspace width="10" style="border:1px"></mspace>\n' +
'				<mi style="border:1px"> ABC </mi>\n' +
'				<mspace width="10" height="0" depth="10" style="border:1px"></mspace>\n' +
'				<mi style="border:1px"> ABC </mi>\n' +
'			</mrow>\n' +
'		</msqrt>\n' +
'	</mrow>\n' +
'	\n' +
'	<mspace linebreak="newline" indentalign="center"></mspace>\n' +
'	<mrow style="border:1px;" dir="rtl"  baseline="true">\n' +
'		<mtext>aaa</mtext>\n' +
'		<msqrt style="border:1px">\n' +
'			<mrow  style="border:1px">\n' +
'				<mi style="border:1px">aagg </mi>\n' +
'				<mo>+</mo>\n' +
'				<mspace width="10" style="border:1px"></mspace>\n' +
'				<mi style="border:1px"> ABC </mi>\n' +
'				<mspace width="10" height="0" depth="10" style="border:1px"></mspace>\n' +
'				<mi style="border:1px"> ABC </mi>\n' +
'			</mrow>\n' +
'		</msqrt>\n' +
'	</mrow>\n' +
'\n' +
'	<mspace linebreak="newline" indentalign="center"></mspace>\n' +
'	<mrow style="border:1px;"  baseline="true">\n' +
'		<mtext>aaa</mtext>\n' +
'		<msqrt>\n' +
'			<msqrt style="border:1px">\n' +
'				<msqrt style="border:1px">\n' +
'					<msqrt style="border:1px">\n' +
'						<msqrt style="border:1px;padding:2px">\n' +
'							<msqrt style="border:1px">\n' +
'								<mi style="border:1px"> ABC </mi>\n' +
'							</msqrt>\n' +
'						</msqrt>\n' +
'					</msqrt>\n' +
'				</msqrt>\n' +
'			</msqrt>\n' +
'		</msqrt>\n' +
'	</mrow>\n' +
'\n' +
'	<mspace linebreak="newline" indentalign="center"></mspace>\n' +
'	<mrow style="border:1px;"  baseline="true">\n' +
'		<mtext>aaa</mtext>\n' +
'		<msqrt closed="true">\n' +
'			<msqrt style="border:1px" closed="true">\n' +
'				<msqrt style="border:1px" closed="true" mathbackground="red">\n' +
'					<msqrt style="border:1px" closed="true">\n' +
'						<msqrt style="border:1px;padding:2px" closed="true">\n' +
'							<msqrt style="border:1px" closed="true">\n' +
'								<mfrac style="border:1px">\n' +
'									<mi style="border:1px"> ABC </mi>\n' +
'									<mi style="border:1px"> ABC </mi>\n' +
'								</mfrac>\n' +
'							</msqrt>\n' +
'						</msqrt>\n' +
'					</msqrt>\n' +
'				</msqrt>\n' +
'			</msqrt>\n' +
'		</msqrt>\n' +
'	</mrow>\n' +
'\n' +
'	<mspace linebreak="newline" indentalign="center"></mspace>\n' +
'	<mrow style="border:1px;" dir="rtl"  baseline="true">\n' +
'		<mtext>aaa</mtext>\n' +
'		<msqrt closed="true">\n' +
'			<msqrt style="border:1px" closed="true">\n' +
'				<msqrt style="border:1px" closed="true" mathbackground="red">\n' +
'					<msqrt style="border:1px" closed="true">\n' +
'						<msqrt style="border:1px;padding:2px" closed="true">\n' +
'							<msqrt style="border:1px" closed="true">\n' +
'								<mfrac style="border:1px">\n' +
'									<mi style="border:1px"> ABC </mi>\n' +
'									<mi style="border:1px"> ABC </mi>\n' +
'								</mfrac>\n' +
'							</msqrt>\n' +
'						</msqrt>\n' +
'					</msqrt>\n' +
'				</msqrt>\n' +
'			</msqrt>\n' +
'		</msqrt>\n' +
'	</mrow>\n' +
'\n' +
'	<mspace linebreak="newline" indentalign="center"></mspace>\n' +
'	<mrow style="border:1px;"  baseline="true">\n' +
'		<mtext mathsize="49">aaa3</mtext>\n' +
'		<mroot style="border:1px">\n' +
'			<mi style="border:1px"> ABC </mi>\n' +
'			<mn style="border:1px"> 12 </mn>\n' +
'		</mroot>\n' +
'	</mrow>\n' +
'	<mrow style="border:1px;"  baseline="true">\n' +
'		<mtext mathsize="49">aaa3</mtext>\n' +
'		<mroot style="border:1px">\n' +
'			<mi style="border:1px"> ABC </mi>\n' +
'			<mn style="border:1px"> 124567 </mn>\n' +
'		</mroot>\n' +
'	</mrow>\n' +
'	<mrow style="border:1px;" dir="rtl"  baseline="true">\n' +
'		<mtext mathsize="49">aaa3</mtext>\n' +
'		<mroot style="border:1px">\n' +
'			<mi style="border:1px"> ABC </mi>\n' +
'			<mn style="border:1px"> 124567 </mn>\n' +
'		</mroot>\n' +
'	</mrow>\n' +
'	<mrow style="border:1px;" dir="rtl" baseline="true">\n' +
'		<mtext mathsize="49">aaa3</mtext>\n' +
'		<mroot style="border:1px">\n' +
'			<mi style="border:1px"> ABC </mi>\n' +
'			<mn style="border:1px"> 12 </mn>\n' +
'		</mroot>\n' +
'	</mrow>\n' +
'	\n' +
'	<mspace linebreak="newline" indentalign="center"></mspace>\n' +
'	<mrow style="border:1px;" baseline="true">\n' +
'		<mtext mathsize="49">aaa3</mtext>\n' +
'		<mroot style="border:1px"  closed="true">\n' +
'			<mi style="border:1px"> ABC </mi>\n' +
'			<mn style="border:1px"> 12 </mn>\n' +
'		</mroot>\n' +
'	</mrow>\n' +
'	<mrow style="border:1px;" baseline="true">\n' +
'		<mtext mathsize="49">aaa3</mtext>\n' +
'		<mroot style="border:1px"  closed="true">\n' +
'			<mi style="border:1px"> ABC </mi>\n' +
'			<mn style="border:1px"> 124567 </mn>\n' +
'		</mroot>\n' +
'	</mrow>\n' +
'	<mrow style="border:1px;" dir="rtl" baseline="true">\n' +
'		<mtext mathsize="49">aaa3</mtext>\n' +
'		<mroot style="border:1px"  closed="true">\n' +
'			<mi style="border:1px"> ABC </mi>\n' +
'			<mn style="border:1px"> 124567 </mn>\n' +
'		</mroot>\n' +
'	</mrow>\n' +
'	<mrow style="border:1px;" dir="rtl" baseline="true">\n' +
'		<mtext mathsize="49">aaa3</mtext>\n' +
'		<mroot style="border:1px"  closed="true">\n' +
'			<mi style="border:1px"> ABC </mi>\n' +
'			<mn style="border:1px"> 12 </mn>\n' +
'		</mroot>\n' +
'	</mrow>\n' +
'\n' +
'	<mspace linebreak="newline" indentalign="center"></mspace>\n' +
'	<mrow style="border:1px;" baseline="true">\n' +
'		<mtext>1</mtext>\n' +
'		<mo>+</mo>\n' +
'		<msqrt>\n' +
'			<mtext>2</mtext>\n' +
'		</msqrt>\n' +
'	</mrow>\n' +
'	\n' +
'</math>';


		updateFormula();

	</script>
</body>
</html>